/**
 * prometheus - 普罗米修斯
 * @author 
 * @version v1.0.91
 * @link 
 * @license MIT
 */
define(["angular","lodash"],function(e,t){"use strict";function s(){this.$get=["$http","$rootScope","$compile","$q","$timeout",function(s,n,u,o,i){var a={SuspensionBoxStatus:!1,box:null,taskQueue:[],addTaskQueue:function(e,t){a.taskQueue.push(t),e.$emit("event:taskQueued",123)},showSuspensionBox:function(){this.SuspensionBoxStatus||(this.SuspensionBoxStatus=!0,this.box=e.element('<div class="hb-ajax-task" hb-parade></div>'),e.element("body").append(u(this.box)(n)))},hideSuspensionBox:function(){0===this.taskQueue.length&&this.SuspensionBoxStatus&&(this.box.remove(),this.box=null,this.SuspensionBoxStatus=!1,a.watchSome())},loadingTask:function(){var n=this;e.forEach(this.taskQueue,function(e,u){e.request||(e.method="get",e.request=!0,e.response=!1,e.requestTime=(new Date).getTime(),e.responseTime=null,e.$$__key="$$__key"+(new Date).getTime(),s(e).success(function(s){e.request=!1,e.response=!0,e.responseTime=(new Date).getTime(),t.remove(n.taskQueue,function(t){return t.$$__key===e.$$__key}),n.hideSuspensionBox()}).error(function(t){e.responseError=!0,e.errorReturn=t}))}),this.showSuspensionBox()}};return a}]}function n(e,t){return{restrict:"AE",template:'<div class="task-queue-con"><div class="task-queue-close"></div><div class="task-queue-content"  ng-repeat="task in taskQueue">{{task.name}}</div></div>',compile:function(s,n){return{post:function(s){s.taskQueue=e.taskQueue,e.watchSome=s.$on("event:taskQueued",function(){t(function(){s.taskQueue=e.taskQueue})})}}}}}var u=e.module("hb.task",[]);u.run(["$rootScope","hbTask","$http","$q","$timeout",function(e,t,s,n,u){e.$on("event:taskQueued",function(e,s){t.loadingTask()})}]),s.$inject=[],u.provider("hbTask",s),n.$inject=["hbTask","$timeout"],u.directive("hbParade",n)});